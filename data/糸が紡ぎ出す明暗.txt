<p><a href="http://www.thevelop.nl/blog/2016-12-25/ThreadTone/" rel="nofollow" title="" class="ext-link">ThreadTone</a> （2016/12/25） by <a href="http://www.thevelop.nl/" rel="nofollow" title="" class="ext-link">Tobias Scheepers</a></p><p>少し前、私は<a href="http://artof01.com/vrellis/index.html" rel="nofollow" title="" class="ext-link">Petros Vrellis</a>が作り出した芸術作品に出会いました。それを見て、私の中のエンジニア魂が叫びました。「自動化だ！」下の画像で分かるように、Petrosは丸い織機を使って糸で肖像画を作ります。しかし、これにはかなりの根気が必要です。これから、私がざっとこのプロセスを自動化するステップをやってみます。しかし、もちろん、称賛されるべきは、この驚くべきアイディアを思い付くきっかけとなったアーティスト本人です。最終的に出来上がるのは、糸だけを使って画像をハーフトーンで表現したものです。</p><p><img src="http://www.thevelop.nl/assets/threadTone/PetrosVrellis.png" alt="Petros Vrellis working on: A new way to knit" title="A new way to knit"><br>
この主なアイデアは、3つのステップに分かれます。ステップ1で、様々な入力画像に対して、糸で作品を表現するためにちょっとした前処理を行います。ステップ2で、最善の画像表現とするために製作者が長い糸をどのように配置していくのか決める処理をPythonで行います。ステップ3では、私の場合、この重労働をこなすためにレーザーカッターをレーザーなしで動作させます。</p><p>ピクセルレベルで画像処理をするのに<a href="http://opencv.org/" rel="nofollow" title="" class="ext-link">openCV</a>を使います。早速、画像の最初の処理をやってみましょう。下のコードの小片は、画像のロード、トリミング、サイズ変更の方法を示しています。</p><p>画像が正しいサイズになれば、グレースケールに変換し、反転させます。この形式では、画像をもともと最も暗かった部分が最も高い値になるような配列として表現することが出来ます。最後に、画像に丸いマスクをかけます（丸の外側の値が全て0に設定されます）。</p><p><img style="float:left; margin-right: 6px;" src="http://www.thevelop.nl/assets/threadTone/cropped.png"><br>
<img style="float:left; margin-right: 6px;" src="http://www.thevelop.nl/assets/threadTone/gray.png"><br>
<img style="float:left; margin-right: 6px;" src="http://www.thevelop.nl/assets/threadTone/inverted.png"><br>
<img style="float:;" src="http://www.thevelop.nl/assets/threadTone/masked.png"></p><p>元の画像を表現するために、糸をどのように通す必要があるかを決定するのが、アルゴリズムの中心的役割です。製作には、ピンが等間隔に並んだ丸い織機を使用することを想定しています。</p><p><video width="350" height="350" autoplay="" loop="" muted=""><source src="http://www.thevelop.nl/assets/threadTone/algo.mp4" type="video/mp4"></source></video></p><p>上のクリップで見られるように、アルゴリズムはランダムなピンから始めます。画像を再現するのに最善のピンを探すためにあらゆる選択肢をチェックします。そして、最適な線を引いて、その線によって加わる”暗さ”を加算すると、最初に戻って同じことを繰り返します。下の関数は、織機のピンの座標と特定の線を表すマスクを生成します。</p><p>上の関数を使って、線が最大数に達するか終了基準が満たされるかのいずれかまで、アルゴリズムが繰り返し画像に線を追加します。画像を特定の線積分で表すには、適応度関数が必要です。もともと暗かった領域の多くを線で覆うことによって、結果として高い適応度を実現します。</p><p>アルゴリズムがそれ以上引くべき線を見つけられなくなったら、ループから抜け出します。その結果をさらに処理することも可能です。以下は、アルゴリズムの結果の2つの例です。それぞれの画像の上にカーソルを合わせると、元の画像が見られます。</p><p><img style="float: left; margin-right: 10px;" src="http://www.thevelop.nl/assets/threadTone/angelineThreaded.png" onmouseover="this.src='http://www.thevelop.nl/assets/threadTone/angelina.png';" onmouseout="this.src='http://www.thevelop.nl/assets/threadTone/angelineThreaded.png';"></p><p><img style="float: ;" src="http://www.thevelop.nl/assets/threadTone/poetinThreaded.png" onmouseover="this.src='http://www.thevelop.nl/assets/threadTone/poetin.png';" onmouseout="this.src='http://www.thevelop.nl/assets/threadTone/poetinThreaded.png';"></p><p>レーザーカッターに重要な作業を任せられるという手軽さにいつも魅力を感じていたので、自作を始めました。大きな投資は必要なく、実際にはレーザー管とレンズを購入しました。ということは、私の学生向けの小さな部屋の大部分がこの大きなデカルトのプロッタに占領されているということです。Petrosのプロジェクトに出会って、やっとこの使い道が決まりました。</p><p><video style="border-radius: 5px;" width="720" height="400" autoplay="" loop="" muted=""><source src="http://www.thevelop.nl/assets/threadTone/cnc.mp4" type="video/mp4"></source></video></p><p>結果の線の座標をGコードにパースすると、数値制御で糸を通すことが出来るようになります。糸の小さなガイドを作るのに、ペンを使いました。以下は、最初の約900本の線に相当する糸が通された状態です。この時点で、糸が切れたので、その日はそこで切り上げました。再度トライする時間ができたら、投稿を更新して最終結果の画像をアップします。</p><p><img style="" src="http://www.thevelop.nl/assets/threadTone/threaded.png"><br>
このコード全体は、<a href="https://github.com/theveloped/ThreadTone" rel="nofollow" title="" class="ext-link">GitHub</a>に投稿されていて、パラメータの調整の方法も書かれています。コメントやアドバイスは大歓迎なので、質問があれば、お気軽にご連絡ください。</p>
