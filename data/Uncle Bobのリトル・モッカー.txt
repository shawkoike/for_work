<p><a href="http://blog.8thlight.com/uncle-bob/2014/05/14/TheLittleMocker.html" rel="nofollow" title="" class="ext-link">The Little Mocker</a> by <a href="https://twitter.com/unclebobmartin" rel="nofollow" title="" class="ext-link">Robert Martin (Uncle Bob)</a></p><p>8th Light’s の名工。Jolt Award受賞作家で、講演者としても有名。1970年からソフトウェア開発にのめり込む。</p><p>以下はモックに関する会話です。</p><p>これは？</p><p>ではこちらは？</p><p>ダミーはどういった場合に使うのですか？</p><p>例えば？</p><p>例を見せていただけますか？</p><p>なるほど。このプログラムを実行するためにはAuthorizerをコンストラクタに渡す必要がありますよね。ですがテストでは誰もログインしませんから、Authorizerのauthorizeメソッドが呼び出されることはないのですね。</p><p>だからダミーのauthorizeメソッドがnullを返してもエラーではないですね。</p><p>なぜです？</p><p>そうか、ダミーを使われたくないから。</p><p>でもこれは「モック」ですよね？　テスト用のこういったオブジェクトはモックと呼ばれると思いますが。</p><p>俗語？</p><p>正式な名前があるのですか？</p><p>映画でいうところの「スタントダブル」（スタントの代役）みたいな？</p><p>ではモックという呼び方はただのスラングなのですね。</p><p>なぜ2種類も呼び方があるのですか？　モックではなくテストダブルだけを使えばいいのでは？</p><p>経緯？</p><p>そういった活用の変化は、言葉に関してはよく起こることですよね。</p><p>「モックしよう」は「テストダブルを作ろう」と言うより簡単ですもんね。</p><p>でも正しい言葉を話さなければいけない時は…</p><p>モックとは、つまり何なのですか？</p><p>どのような？</p><p>スタブとは？</p><p>trueを返していますよ。</p><p>なぜです？</p><p>ログイン済みですが。</p><p>簡単だから？</p><p>うーん。話を進めるために、賛成しておきます。それで？</p><p>これで疑いなしにユーザに権限を与えるのですね。</p><p>そして、もし権限を持たないユーザを扱うシステムのテストを行いたければ、falseを返すスタブを使えばいいのですね。</p><p>他にはどんなのが？</p><p>これは「スパイ」と呼ばれるものですね。</p><p>スパイを使う目的は？</p><p>ああ、なるほど。テストでスタブのように注入すれば、authorizerWasCalledの変数をチェックして、システムが本当にauthorizeを呼び出すかを確認するのですね。</p><p>ではスパイは、呼び出し元の監視役ですね。あらゆる情報を記録できるのだと思いますが。</p><p>なるほど。それなら呼び出しの度に、渡された引数のリストを保持することもできますね。</p><p>結合しているようですね。</p><p>もろいとは？</p><p>例えばコードを変更したら、壊れるテストもあるということですか。</p><p>分かりました。では、他にもテストダブルの方法はありますか？</p><p>モックですね。</p><p>本来の？</p><p>なるほど、テストの結果を基にしたアサーションを、モックのベリファイメソッドに入れるようなものですね。</p><p>じゃあ、アサーションをモックに入れるだけでいいのですね？</p><p>振る舞い？</p><p>それでは、モックは監視の役割をしていると？</p><p>うーん。モックにエクスペクテーションを入れたら、結合のテストみたいですね。</p><p>では、どうしてその方法を？</p><p>モックツール？</p><p>なんだか複雑そうですけど。</p><p>本も出ていますよね？</p><p>なるほど。では、あともう1つのテストダブルとはなんですか？</p><p>おかしいな。これでは“ボブ”というユーザ名を使えば誰でも権限を与えられてしまいますよ。</p><p>いわゆるシミュレータのようなものということですか。</p><p>フェイクとスタブとは違うんですね？</p><p>それではフェイクは根本的なレベルで別物というわけですね。</p><p>フェイクは複雑だろうということが想像できますよ。</p><p>うーん。</p><p>何ですって？　それじゃあ、今は何を使っているんですか。他のテストダブルは使っているのでしょう？</p><p>ダミーもですか？</p><p>モックはどうですか？</p><p>でも、先ほどモックツールは使わないと言われましたよ。</p><p>では、なぜ？</p><p>単なる使いやすさの問題ということですか？</p><p>なるほどね。有益なお話をありがとうございました。</p><p>[1] <a href="http://www.amazon.com/xUnit-Test-Patterns-Refactoring-Code/dp/0131495054" rel="nofollow" title="" class="ext-link">xUnit Test Patterns</a></p>
