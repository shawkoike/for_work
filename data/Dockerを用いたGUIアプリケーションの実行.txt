<p><a href="http://fabiorehm.com/blog/2014/09/11/running-gui-apps-with-docker/" rel="nofollow" title="" class="ext-link">Running GUI apps with Docker</a> (2014-9-11) by <a href="https://twitter.com/fgrehm" rel="nofollow" title="" class="ext-link">Fábio Rehm</a></p><p>私はこのところしばらく仕事でVMやコンテナを扱っていましたが、大学のいくつかのプロジェクトでJavaのコードを書かなければならないときは未だにvimを使用せず、新たに本格的なIDEをインストールしなければなりませんでした。これにはいつもイライラさせられていましたが、ついに今週、Dockerコンテナ内でNetBeansを実行できるようになったのです。それによって普段使用しないJavaのコードを書くための膨大な環境をパソコンにインストールしなくて済むようになりました。</p><p>Dockerコンテナ内でGUIアプリケーションを実行する場合には、いくつかの方法があり、<a href="http://blog.docker.com/2013/07/docker-desktop-your-desktop-over-ssh-running-inside-of-a-docker-container/" rel="nofollow" title="" class="ext-link">X11転送を行うSSH</a>や<a href="http://stackoverflow.com/a/16311264" rel="nofollow" title="" class="ext-link">VNC</a>を使用します。しかし私が発見した最もシンプルな方法は、X11のソケットをコンテナと共有して、直接使用するというものでした。</p><p>このアイデアはとてもシンプルで、以下の<code>Dockerfile</code>を開始点として使用するFirefoxコンテナを実行することで、簡単に試すことができます。</p><p><code>docker build -t firefox .</code> を実行し、次に以下のコードでコンテナを実行します。</p><p>すべてうまくいけば、FirefoxがDockerコンテナ内から実行されていることが確認できるはずです。</p><p>
<figure class="center">
  <a href="http://fabiorehm.com/images/posts/2014-09-11/firefox-demo.gif" class="image-popup ext-link" rel="nofollow" title=""><img src="http://fabiorehm.com/images/posts/2014-09-11/firefox-demo.gif"></a><br>
</figure>
</p><p>NetBeansのベースイメージを準備するのは容易ではありませんでした。X11のソケットに正しく接続できるようにするために、さらにいくつかの依存パッケージ（具体的には<code>libxext-dev</code>、<code>libxrender-dev</code>、<code>libxtst-dev</code>パッケージです）をインストールする必要があるからです。また、Oracle Javaを動かすにはOpenJDKを使用する必要があり、この扱いにも苦労しました。</p><p>そして試行錯誤の末、ようやく問題なく動作するようになり、ベースイメージが出来上がりました。このベースイメージは<a href="https://registry.hub.docker.com/u/fgrehm/netbeans/" rel="nofollow" title="" class="ext-link">Docker Hub</a>から入手でき、ソースは<a href="https://github.com/fgrehm/docker-netbeans" rel="nofollow" title="" class="ext-link">GitHub</a>にあります。</p><p>では、簡単なデモをお見せしましょう。</p><p>
<figure class="center">
  <a href="http://fabiorehm.com/images/posts/2014-09-11/firefox-demo.gif" class="image-popup ext-link" rel="nofollow" title=""><img src="http://fabiorehm.com/images/posts/2014-09-11/netbeans-demo.gif"></a><br>
</figure>
</p><p>これから数カ月間は<a href="https://www.playframework.com/" rel="nofollow" title="" class="ext-link">Play</a>のアプリケーションを構築しようと思います。どんなワークフローを使ったかについて、ブログに書ければいいなと思っています。お楽しみに！</p><p><em>追伸：ここに書いたX11のソケットの共有方法は<a href="https://github.com/fgrehm/vagrant-lxc" rel="nofollow" title="" class="ext-link">vagrant-lxc</a>コンテナにも適用されます。機会があれば、プロジェクトのWikiにこれについて詳しく書こうと思っています。</em></p>
