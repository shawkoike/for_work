<p><a href="https://hackernoon.com/from-what-is-a-markov-model-to-here-is-how-markov-models-work-1ac5f4629b71" rel="nofollow" title="" class="ext-link">From “What is a Markov Model” to “Here is how Markov Models Work”</a> （2017-01-30） by <a href="https://hackernoon.com/@alexdejeu" rel="nofollow" title="" class="ext-link">Alexander Dejeu</a></p><p><span class="trans-notice">本記事は、元記事を翻訳した記事の前編となります。</span><br>
<span class="trans-notice">B/C/D節については後編をご参照ください。</span></p><p>“マルコフモデルとは何か” という議論は昔からありますが、もし皆さんがその答えを知りたいのであれば、正直なところ、ウィキペディアを見る（または以下のTLDRだけを読む😉）ことをお勧めします。一方、マルコフモデルの概要やこのモデルが重要である理由、およびその実装方法に興味があり、サンプルを通じて理解を深めたいという方は、この記事を引き続きご覧ください(^ ^)。以下で、<strong>具体例を挙げて説明します。</strong></p><p>ロードマップはとても重要です。この記事のロードマップにあたる<strong>目次</strong>は、以下の通りです。🚗</p><p><strong>A. マルコフモデルの概要👶 <span class="trans-notice">訳注:前編</span></strong></p><p><strong>B. もう一歩進んだマルコフモデル😼 <span class="trans-notice">訳注:後編</span></strong></p><p><strong>C. Pythonでの実装🐍 <span class="trans-notice">訳注:後編</span></strong></p><p><strong>D. 参考資料、提案と考察💚 <span class="trans-notice">訳注:後編</span></strong></p><p>マルコフモデルは、例を使って説明するのが一番分かりやすいでしょう。ここで取り上げる以下の例は、私自身が<a href="https://medium.com/@makeschool" rel="nofollow" title="" class="ext-link">Make School</a>でマルコフモデルを学んだ際に使ったものです。</p><p>マルコフモデルを学ぶ前に、まずは<strong>指定の最初の文</strong>と<strong>重み分布</strong>、および<strong>ヒストグラム</strong>について十分に理解しておく必要があります。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*Q20t6KQDq0GhrF-NCyqxHg.png" src="https://cdn-images-1.medium.com/max/800/1*Q20t6KQDq0GhrF-NCyqxHg.png"><br>
<span class="center">最初の文</span></p><p>この最初の文は有名なフレーズですが、一見したところ特に目を引く要素はありません。では、この文を分解して、<em>構成要素</em>について見ていきましょう。具体的には、この文は8単語（<strong>トークン</strong>）から成ります。ただし、一意の単語（<strong>キー</strong>）は5つだけです。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*GwzLn-9tMkRI4dRclS3now.png" src="https://cdn-images-1.medium.com/max/800/1*GwzLn-9tMkRI4dRclS3now.png"><br>
<span class="center">色付けした最初の文</span></p><p>ここでは一意の単語（<strong>キ―</strong>）に異なる色を割り当てました。一見すると、ただの色付けした文にしか見えませんが、実は各<strong>キー</strong>に別の色を付けたのには意味があります。一意の<strong>キー</strong>を色分けすることで、特定の<strong>キー</strong>が他のものより多く出現していることが分かるのです。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*gnwXq22M3L3-bBXibqXqaw.png" src="https://cdn-images-1.medium.com/max/800/1*gnwXq22M3L3-bBXibqXqaw.png"><br>
<span class="center">キーの分布</span></p><p>上の<strong>キー</strong>の<strong>分布</strong>を見ると、fishという<strong>キー</strong>が他の<strong>キー</strong>よりも4倍多く出現していると推測できます。このことから、最初の文において任意の位置で次の単語をランダムに抽出した場合、「fish」が得られる確率が高いと予測することもできます。他の単語に比べて、fishは非常に多く使用されているためです。💯</p><p>今回の<strong>重み分布</strong>の場合、任意のキーが出現する確率は、そのキーが出現する合計回数をトークンの総数で割ったものになります。例えば、fishは8単語中4回出てきているので、重み分布は50％です。また、One、two、red、blueの出現確率はそれぞれ12.5％(1/8)になります。</p><p><strong>ヒストグラム</strong>は、重み分布を表現するための手法です。通常は、一連の計量値の度数分布を認識できるように描画したものです。この例では、多数の単語（計量値）から成る<em>文</em>が連続データということになります。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*sqA96Aytk6GG1IIMlPR_EA.png" src="https://cdn-images-1.medium.com/max/800/1*sqA96Aytk6GG1IIMlPR_EA.png"><br>
<span class="center">最初の文のヒストグラム</span></p><p>この最初の文の<strong>ヒストグラム</strong>を見ると、これらの単語の基本的な分布を<strong>視覚的に👀</strong>かつ明確に把握できます。実際、データセットの中でfishが最も多く出現していることが一目で分かると思います🐠🐟 🐡🐠</p><p>やりましたね！　今では、<em>文</em>が多くの<strong>トークン</strong>と<strong>キー</strong>で出来ているという概念を受け入れたことと思います。さらに、<strong>ヒストグラム</strong>と<strong>重み分布</strong>の関係も理解しているでしょう。</p><p>✅💯✅ <strong>補足の例</strong> ✅💯✅</p><p><strong>トークン</strong>というのは、文中の単語のことです。<br>
<strong>キー</strong>というのは、個々の単語の出現を指します。<br>
<strong>例：</strong> <em>“Fish Fish Fish Fish Cat”</em>には2個の<strong>キー</strong>と5個の<strong>トークン</strong>があります。キーは “Fish” と “Cat” (🐠 と 😺)です。また単語1つ1つがトークンです。<br>
ヒストグラムは重み分布に関連付けられます。なぜなら、ヒストグラムを見ると、連続データセットにおける頻度が視覚的に分かり、それは基本的にデータの重み分布を示しているからです。</p><p>✅💯✅ <strong>補足終わり</strong> ✅💯✅</p><p>いいことです。これで文の外観と、ある単語が別の単語と比べてどのように多く出現するかを理解しました。しかし、先に進む前に、表面上で隠れているものの誰もが存在を認める特別な付加要素を文に追加しなければなりません。文の<strong>Ｓｔａｒｔ</strong>と<strong>Ｅｎｄ</strong>です…。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*U06RW22yqWz8tK9gMeQ3MA.png" src="https://cdn-images-1.medium.com/max/800/1*U06RW22yqWz8tK9gMeQ3MA.png"><br>
<span class="center">特別な付加事項が付いた最初の文</span></p><p>すてきです！　ちょっと時間を取って、元々の文に対する上の “付加要素” を調べましょう。今、これは不要な作業に見えます。しかし信じてほしいのですが、次のパート、つまりマルコフモデルに踏み込んだ際に、急に意味を持ち始めます。😌 要約すると、全ての文は隠れた “<em>START</em>” という目印で開始され、常に “<em>END</em>” という目印で締めくくられます。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*okyW8itkBNhiugBqZX3k0A.png" src="https://cdn-images-1.medium.com/max/800/1*okyW8itkBNhiugBqZX3k0A.png"><br>
<span class="center">変更した例におけるキーの分布</span></p><p>上記では、先へ進めて、前の例に2つの追加キー（<em>START</em>と<em>END</em>）を加えて、前と同様にキーの分布を再構成しました。</p><p>すごいですよ！　すでに何かしら学んでいるかもしれませんが、ついに本記事の核心に来ました。まず、マルコフモデルとは<em>何か</em>について難しい定義から始めましょう（<a href="https://en.wikipedia.org/wiki/Markov_model" rel="nofollow" title="" class="ext-link">ウィキペディア</a>によるものです。）</p><p>すごいですね！　面白そうです…　しかし、この大げさでつかみどころのないものは、一体何を意味しているのでしょうか？　マルコフモデルとは<em>何か</em>について<strong>重要な</strong>ところを太字にしておきました。要約すると、マルコフモデルとは、<strong>次の状態</strong>が<strong>現在の状態</strong>のみに基づくとするモデルです。</p><p>このことについて1つの考え方を挙げると、現在の状態（この文章の場合は1つのトークン）だけが見えるウィンドウがあり、この小さなウィンドウに基づいて次のトークンを決めなければならないというものです！</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*xZwT88rLbYZhvAkx-XbOsw.png" src="https://cdn-images-1.medium.com/max/1200/1*xZwT88rLbYZhvAkx-XbOsw.png"><br>
<span class="center">ウィンドウを使った次の単語の指示</span></p><p>上の図で、トークンからトークンへのつながりを示しました。さらに、元のキーごとに色分けし、次の単語へ向かう矢印に色を付けています。この図と下の図に少しばかり時間を費やすことをお勧めします。というのも、これによってマルコフモデルが<em>どのように</em>動くかの基礎が築かれるからです。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*10vdH6xwkhX93ETi9ATsIw.png" src="https://cdn-images-1.medium.com/max/1200/1*10vdH6xwkhX93ETi9ATsIw.png"><br>
<span class="center">ペア登場。あるトークンから別のトークンへ！</span></p><p>どのトークンも別のトークンにつながることにお気づきでしょう（<em>END</em>でさえも、<em>none</em>という別のトークンにつながります）。この場合、あるトークンと別のトークンのペアが出来上がるのです！</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*UGdrm8lZmk1Lp3OxguaYWA.png" src="https://cdn-images-1.medium.com/max/1200/1*UGdrm8lZmk1Lp3OxguaYWA.png"><br>
<span class="center">最初の単語に基づいた構成</span></p><p>上記では、最初のトークンによってペアをまとめました。もう、面白いことにお気づきかもしれません。先行するトークンは、自らがつなげられるキー<strong>だけ</strong>からつながりを受けています。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*QEIDJPVBcct-Jld6cDdUKQ.png" src="https://cdn-images-1.medium.com/max/1200/1*QEIDJPVBcct-Jld6cDdUKQ.png"><br>
<span class="center">各キーがつなげられるトークン</span></p><p>さて、ここまでの話は大丈夫でしょうか。 “<strong>ウィンドウ</strong>” によって形成されるペアを構成し、ペアになる次のトークンは何かを調べているということを理解していただけているでしょう。そのあと、ペアをさらに興味深いものへと軽量化しました。全ての<strong>キー</strong>はそのキーに続く可能性があるトークンの配列と照合されます。</p><p>✨💡✨ <strong>小休止して考察</strong> ✨💡✨</p><p>上に示した図について、ちょっと考察してみましょう。全ての<strong>キー</strong>は、それに続けることが<em>できるだろう</em>単語を持っています。誰かが上記の構造を与えられた場合、もしかしたら元の文を再現できるかもしれません。</p><p><strong>例：</strong></p><p>最初に<strong>＊Start＊</strong>を与えます。それから、<em>START</em> → [One]に従う<em>であろう</em>単語の選択肢を見てみます。それは、次に選択しなければならない唯一のキーになります。今、この文では”One”ということになるようです。それでは”One” → [fish]に従う<em>であろう</em>単語を見て、先へ進んでみましょう。今度も同じ、これは簡単ですね。Oneに続けられるのは”fish”だけです。ということで、文は、”One fish”となります。それでは、”fish” → [two, red, blue, <em>END</em>]に従う<em>であろう</em>ものを見ていきましょう。ここで、面白くなってきました。4つの選択肢の中から、どれでも次のものとして選ぶことができます。😳 つまり、”two”を選び先に進む<em>ことができた</em>とすれば、もしかすると、元々の文が得られるかもしれません。しかし無作為に”<em>END</em>“を選ぶ<em>であろう</em>確率は25%(1/4)です。この場合は、元の構造を使ったとしても、元の”One fish” 1️⃣ 🐠 とはかなり違った文を無作為に生成するでしょう。<br>
✨💡✨ <strong>考察終わり</strong> ✨💡✨</p><p>おめでとうございます🎉🎉。上で述べた<strong>小休止して考察</strong>の中でマルコフモデルをまさにひそかに実行していたのです。😏<br>
 素晴らしいです。しかし真面目な話、そのことについて考えてみてください。私たちは、<strong>次の状態</strong>を決定するために、<strong>現在の状態</strong>（現在のキー）を使いました。更に次の状態は、現在のキーに従うキーだけなのかもしれません。なかなかよさそうですが、さらに良くなっていきます。最初の文について、マルコフモデルを図に表してみましょう。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*x4CnHyAqGkPa7ews_5f0sQ.png" src="https://cdn-images-1.medium.com/max/1200/1*x4CnHyAqGkPa7ews_5f0sQ.png"><br>
<span class="center">最初の文のマルコフモデル</span></p><p>さて、上の図は、私たちが実行したことをどのように表しているのでしょうか。詳しく見てください。単語が中に書かれた<em>楕円</em>は<strong>キー</strong>を表しており、その単語に続く可能性がある<strong>キー</strong>を示す矢印が描かれています。でもちょっと待ってください、もっとカッコよくなります。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*UuD1-B7CFn3M2nUDy02sHg.png" src="https://cdn-images-1.medium.com/max/1200/1*UuD1-B7CFn3M2nUDy02sHg.png"><br>
<span class="center">確率を伴った最初の文のマルコフモデル</span></p><p>そうです。矢印はどれも、現在の状態から次の状態へと続くパスとして選ばれる確率を伴っています。</p><p><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*MbHRwYNA8F29hzes8EPHiQ.gif" src="https://cdn-images-1.medium.com/max/1200/1*MbHRwYNA8F29hzes8EPHiQ.gif"><br>
<span class="center">マルコフモデルを用いて作成された、最初の文の完全図</span></p><p>すごいですね。要するに、ドクター・スースの文を用いることにより、マルコフモデルを図解しました。<strong>面白い事実</strong>として、モデルを作るために使用したデータは、<strong>コーパス</strong>と呼ばれます。👻</p><p>やりましたね。改めておめでとうございます。この時点で、あなたはマルコフモデルが何であるかを述べることができるでしょう。そして、この基本例と同じものを使って、恐らく他の誰かに教える事さえできるでしょう。順調に進んでいます。🚀 でも想像してみてください。これは、マルコフモデルへの理解をさらに深めようとする次のセクションに向けての単なる出発点に過ぎません。分布を覚えているでしょうか。そうですね、次の例で分布を使うつもりです。これは、<em>潜在的に</em>もっと実際的なモデルを作成するため、<strong>重み分布</strong>をどのように使うかを示すためです。更に、<strong>より大きなウィンドウ</strong>について話そうと思います😲（大きな方が良いですよね🙄）。そして、最後に、Python🐍でよくできたマルコフモデルを実装しましょう。そして気を引き締めて楽しみながら先に進みましょう。🔥🎢</p>
